<!doctype html>
<html lang="he" dir="rtl" class="overflow-x-hidden">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="theme-color" content="#0f172a" />
    <title>צייד המציאות | Reality Hunter</title>

    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="צייד המציאות - המקום שלך למצוא את המכרזים והעסקאות המשתלמות ביותר. בואו לחפש, להשוות ולזכות!"
    />
    <meta
      name="keywords"
      content="מכרזים, עסקאות, צייד מציאות, קניות, כונס נכסים"
    />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind CSS (via CDN for basic structure) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind Customization & Custom CSS -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Heebo", "sans-serif"],
            },
            colors: {
              brand: {
                50: "#f0fdfa",
                100: "#ccfbf1",
                400: "#2dd4bf",
                500: "#14b8a6",
                600: "#0d9488",
                900: "#134e4a",
              },
            },
          },
        },
      };
    </script>

    <style>
      body {
        background-color: #0f172a; /* Slate 900 */
        color: #f8fafc; /* Slate 50 */
        -webkit-tap-highlight-color: transparent;
      }

      /* Glassmorphism Classes */
      .glass-header {
        background: rgba(15, 23, 42, 0.7);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      }

      .card-glass {
        background: rgba(30, 41, 59, 0.6);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow:
          0 10px 15px -3px rgba(0, 0, 0, 0.2),
          0 4px 6px -2px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .card-glass:hover {
        border-color: rgba(45, 212, 191, 0.3); /* brand-400 with opacity */
        box-shadow: 0 10px 25px -3px rgba(20, 184, 166, 0.15);
        transform: translateY(-4px);
      }

      /* Ambient Glows */
      .glow-blob {
        position: absolute;
        border-radius: 50%;
        filter: blur(80px);
        z-index: -1;
        opacity: 0.4;
        pointer-events: none;
      }

      .glow-1 {
        top: -10%;
        right: -5%;
        width: 400px;
        height: 400px;
        background: radial-gradient(
          circle,
          rgba(20, 184, 166, 0.3) 0%,
          rgba(15, 23, 42, 0) 70%
        );
      }

      .glow-2 {
        bottom: 10%;
        left: -10%;
        width: 500px;
        height: 500px;
        background: radial-gradient(
          circle,
          rgba(99, 102, 241, 0.2) 0%,
          rgba(15, 23, 42, 0) 70%
        );
      }

      /* Mobile specific adjustments to ensure layout doesn't break on Safari/Chrome */
      @supports (-webkit-touch-callout: none) {
        .min-h-screen {
          min-height: -webkit-fill-available;
        }
      }
    </style>
  </head>
  <body
    class="min-h-screen flex flex-col antialiased selection:bg-brand-500 selection:text-white overflow-x-hidden"
  >
    <!-- Ambient Background Lighting -->
    <div class="fixed inset-0 pointer-events-none overflow-hidden z-0">
      <div class="glow-blob glow-1"></div>
      <div class="glow-blob glow-2"></div>
    </div>

    <!-- Header -->
    <header
      class="glass-header text-white sticky top-0 z-50 w-full transition-all duration-300"
      id="main-header"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-20">
          <!-- Logo & Brand Name -->
          <div class="flex items-center gap-3">
            <div
              class="w-12 h-12 rounded-2xl bg-gradient-to-br from-brand-400 to-indigo-600 flex items-center justify-center shadow-lg shadow-brand-500/20"
            >
              <!-- Search/Radar Icon for 'Hunter' -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2.5"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-white"
              >
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </div>
            <h1 class="text-2xl font-extrabold tracking-tight">
              <span class="text-white">צייד </span
              ><span
                class="bg-clip-text text-transparent bg-gradient-to-r from-brand-400 to-indigo-400"
                >המציאות</span
              >
            </h1>
          </div>

          <!-- Desktop Navigation -->
          <nav class="hidden md:flex items-center space-x-8 space-x-reverse">
            <a
              href="#"
              class="text-white font-medium hover:text-brand-400 transition-colors"
              >ראשי</a
            >
            <a
              href="mailto:chiprut20@gmail.com"
              class="text-slate-300 font-medium hover:text-white transition-colors"
              >צור קשר</a
            >
          </nav>

          <!-- Mobile Menu Button -->
          <div class="md:hidden flex items-center">
            <button
              id="mobile-menu-btn"
              aria-label="תפריט"
              class="text-slate-300 hover:text-white p-2 focus:outline-none"
            >
              <svg
                class="h-7 w-7"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content Section -->
    <main
      class="flex-grow w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 lg:py-16 relative z-10 w-full overflow-hidden"
    >
      <!-- Welcome / Hero Header -->
      <div class="mb-10 text-center flex flex-col items-center">
        <h2
          class="text-4xl md:text-5xl lg:text-5xl font-extrabold text-white mb-4 tracking-tight"
        >
          המכרזים
          <span
            class="text-transparent bg-clip-text bg-gradient-to-l from-indigo-400 to-brand-400"
            >החמים ביותר</span
          >
        </h2>
        <p class="text-lg md:text-xl text-slate-400 max-w-3xl leading-relaxed">
          ברוכים הבאים למערכת <strong>צייד המציאות</strong>. 
          אנו אוספים עבורכם עסקאות משתלמות ישירות ממאגרי הממשלה (רכבי ממשלה ממינהל הרכב, משטרה/מכס, רכבי וציוד הוצאה לפועל ונדל"ן עזוב מהאפוטרופוס הכללי).
          הנתונים נשאבים ומתעדכנים <strong>מדי יום בשעה 08:00 בבוקר</strong> כדי להבטיח שתמיד תהיו צעד אחד לפני כולם!
        </p>
      </div>

      <!-- Controls (Filter & Sort) -->
      <div class="mb-8 flex flex-col md:flex-row gap-4 items-center justify-between bg-slate-800/40 p-4 rounded-2xl border border-slate-700/50 backdrop-blur-sm">
        <div class="flex flex-wrap gap-2 w-full md:w-auto" id="filter-buttons">
          <button class="filter-btn px-4 py-2 rounded-xl bg-brand-500 text-white font-medium text-sm transition-colors" data-filter="all">הכל</button>
          <button class="filter-btn px-4 py-2 rounded-xl bg-slate-700 text-slate-300 hover:bg-slate-600 font-medium text-sm transition-colors" data-filter="car">רכבים</button>
          <button class="filter-btn px-4 py-2 rounded-xl bg-slate-700 text-slate-300 hover:bg-slate-600 font-medium text-sm transition-colors" data-filter="real_estate">נדל"ן</button>
          <button class="filter-btn px-4 py-2 rounded-xl bg-slate-700 text-slate-300 hover:bg-slate-600 font-medium text-sm transition-colors" data-filter="equipment">ציוד (הוצל"פ)</button>
        </div>
        <div class="flex items-center gap-3 w-full md:w-auto">
          <label class="text-slate-400 text-sm whitespace-nowrap hidden sm:block">סנן לפי:</label>
          <select id="price-sort" class="bg-slate-900 border border-slate-700 text-white text-sm rounded-xl focus:ring-brand-500 focus:border-brand-500 block w-full p-2.5 outline-none">
            <option value="default">ממליץ מהחדש לישן</option>
            <option value="cheap">מהזול ליקר</option>
            <option value="expensive">מהיקר לזול</option>
            <option value="profit">אחוז רווח פוטנציאלי</option>
          </select>
        </div>
      </div>

      <!-- Deals Grid (Auction Placeholders) -->
      <section
        id="auctions-grid"
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8"
      >
        <!-- Dynamic content will be injected here via JavaScript -->
        <div class="col-span-full text-center py-12 text-slate-400">
            <div class="inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] text-brand-500 motion-reduce:animate-[spin_1.5s_linear_infinite]" role="status">
                <span class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]">Loading...</span>
            </div>
            <p class="mt-4 text-lg font-medium">טוען מכרזים...</p>
        </div>
      </section>
    </main>

    <!-- Light Footer -->
    <footer
      class="border-t border-slate-800/80 bg-slate-900/50 mt-auto py-8 relative z-10"
    >
      <div
        class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center gap-4"
      >
        <p class="text-slate-500 text-sm font-medium">
          &copy; 2026 צייד המציאות. כל הזכויות שמורות.
        </p>
        <div class="flex gap-6">
          <a
            href="mailto:chiprut20@gmail.com"
            class="text-slate-500 hover:text-brand-400 transition-colors font-medium text-sm"
          >
            צור קשר
          </a>
        </div>
      </div>
    </footer>
    <script>
      document.addEventListener('DOMContentLoaded', async () => {
        const grid = document.getElementById('auctions-grid');
        const filterButtons = document.querySelectorAll('.filter-btn');
        const sortSelect = document.getElementById('price-sort');
        let allDeals = [];
        let currentFilter = 'all';
        let currentSort = 'default';

        function renderDeals(dealsToRender) {
          grid.innerHTML = '';
          
          if (!dealsToRender || dealsToRender.length === 0) {
            grid.innerHTML = `<div class="col-span-full text-center p-12 bg-slate-800/40 rounded-3xl border border-slate-700/50 shadow-xl backdrop-blur-sm">
              <div class="w-16 h-16 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-400"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
              </div>
              <h3 class="text-2xl font-bold text-white mb-2">לא נמצאו עסקאות</h3>
              <p class="text-slate-400 max-w-md mx-auto">כרגע אין מכרזים פעילים במערכת שתואמים לחיפוש שלך.</p>
            </div>`;
            return;
          }

          dealsToRender.forEach(deal => {
            const profitPercentage = Math.round(((deal.marketValue - deal.openingPrice) / (deal.marketValue || 1)) * 100) || 0;
            
            const formatter = new Intl.NumberFormat('he-IL', {
              style: 'currency',
              currency: 'ILS',
              minimumFractionDigits: 0,
              maximumFractionDigits: 0
            });
            
            const marketStr = formatter.format(deal.marketValue || 0);
            const openingStr = formatter.format(deal.openingPrice || 0);
            
            let badgeClass = 'bg-brand-500 border-brand-400';
            let iconSvg = '';
            let bgGradientClass = 'from-indigo-500/40 text-brand-500/40';
            let timeBadgeClass = 'bg-slate-900/80 text-white';

            if (deal.type === 'car') {
              badgeClass = 'bg-emerald-500 border-emerald-400';
              bgGradientClass = 'from-indigo-500/40 to-brand-500/40';
              iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/><path d="M15 18H9"/><path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/><circle cx="17" cy="18" r="2"/><circle cx="7" cy="18" r="2"/></svg>`;
            } else if (deal.type === 'real_estate') {
              badgeClass = 'bg-indigo-500 border-indigo-400';
              bgGradientClass = 'from-sky-500/40 to-indigo-500/40';
              iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>`;
            } else if (deal.type === 'equipment') {
              badgeClass = 'bg-rose-500 border-rose-400';
              bgGradientClass = 'from-fuchsia-500/40 to-brand-500/40';
              timeBadgeClass = 'bg-rose-500/20 text-rose-300 border-rose-500/30 animate-pulse';
              iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-white"><circle cx="12" cy="12" r="7"></circle><polyline points="12 9 12 12 13.5 13.5"></polyline><path d="M16.51 17.35l-.35 3.83a2 2 0 0 1-2 1.82H9.83a2 2 0 0 1-2-1.82l-.35-3.83m.01-10.7l.35-3.83A2 2 0 0 1 9.83 1h4.35a2 2 0 0 1 2 1.82l.35 3.83"></path></svg>`;
            }
            
            const cardHTML = `
        <article class="card-glass rounded-3xl overflow-hidden flex flex-col h-full group">
          <div class="h-56 relative overflow-hidden bg-slate-800">
            <div class="absolute inset-0 bg-gradient-to-br ${bgGradientClass} group-hover:scale-105 transition-transform duration-500"></div>
            <div class="absolute inset-0 flex items-center justify-center opacity-50">
              ${iconSvg}
            </div>
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10"></div>
            <div class="absolute top-4 right-4 z-20 ${badgeClass} text-white text-sm font-bold px-3 py-1.5 rounded-full shadow-lg flex items-center gap-1.5 border border-white/20">
              <span dir="rtl">${profitPercentage}% מתחת למחירון</span>
            </div>
            <div class="absolute top-4 left-4 z-20 ${timeBadgeClass} text-xs font-semibold px-2.5 py-1 rounded-full border border-slate-700 backdrop-blur-md">
              ${deal.timeLeft}
            </div>
          </div>
          
          <div class="p-6 md:p-7 flex-grow flex flex-col gap-4">
            <h3 class="text-xl font-bold text-white group-hover:text-brand-400 transition-colors line-clamp-2 leading-snug">
              ${deal.title}
            </h3>
            
            <div class="bg-slate-800/50 rounded-2xl p-4 mt-auto border border-slate-700/50">
              <div class="flex justify-between items-center mb-2">
                <span class="text-slate-400 text-sm font-medium">שווי שוק מוערך:</span>
                <span class="text-slate-500 font-semibold line-through decoration-red-500/50 text-sm" dir="ltr">${marketStr}</span>
              </div>
              <div class="flex justify-between items-end">
                <span class="text-brand-400 text-sm font-bold flex items-center gap-1.5">
                  <span class="w-2 h-2 rounded-full bg-brand-500 animate-pulse"></span>
                  מחיר פתיחה:
                </span>
                <span class="text-2xl font-extrabold text-white" dir="ltr">${openingStr}</span>
              </div>
            </div>
            
            <a href="${deal.link || '#'}" target="_blank" rel="noopener noreferrer" class="w-full mt-2 bg-gradient-to-r from-brand-600 to-brand-500 hover:from-brand-500 hover:to-brand-400 text-white font-bold py-3.5 px-4 rounded-xl shadow-lg shadow-brand-500/25 transition-all active:scale-[0.98] flex items-center justify-center gap-2">
              <span>לצפייה בפרטים</span>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="rotate-180"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
            </a>
          </div>
        </article>
            `;
            grid.insertAdjacentHTML('beforeend', cardHTML);
          });
        }

        function applyFiltersAndSort() {
          let filteredDeals = [...allDeals];
          
          if (currentFilter !== 'all') {
            filteredDeals = filteredDeals.filter(d => d.type === currentFilter);
          }
          
          if (currentSort === 'cheap') {
            filteredDeals.sort((a, b) => a.openingPrice - b.openingPrice);
          } else if (currentSort === 'expensive') {
            filteredDeals.sort((a, b) => b.openingPrice - a.openingPrice);
          } else if (currentSort === 'profit') {
            filteredDeals.sort((a, b) => {
              const profitA = ((a.marketValue - a.openingPrice) / (a.marketValue || 1));
              const profitB = ((b.marketValue - b.openingPrice) / (b.marketValue || 1));
              return profitB - profitA;
            });
          } else {
             // By default, assume recently appended deals are newer, so reverse them
             filteredDeals.reverse();
          }
          
          renderDeals(filteredDeals);
        }

        // Initialize UI Events
        filterButtons.forEach(btn => {
          btn.addEventListener('click', (e) => {
            filterButtons.forEach(b => {
              b.classList.remove('bg-brand-500', 'text-white');
              b.classList.add('bg-slate-700', 'text-slate-300');
            });
            e.target.classList.remove('bg-slate-700', 'text-slate-300');
            e.target.classList.add('bg-brand-500', 'text-white');
            
            currentFilter = e.target.getAttribute('data-filter');
            applyFiltersAndSort();
          });
        });

        sortSelect.addEventListener('change', (e) => {
          currentSort = e.target.value;
          applyFiltersAndSort();
        });

        try {
          // Append timestamp to prevent aggressive caching
          const response = await fetch('deals.json?t=' + new Date().getTime());
          if (!response.ok) throw new Error('Failed to fetch deals');
          
          const deals = await response.json();
          allDeals = deals || [];
          applyFiltersAndSort();
          
        } catch (error) {
          console.error('Error fetching deals:', error);
          grid.innerHTML = `<div class="col-span-full text-center p-8 bg-slate-800/50 rounded-2xl border border-slate-700">
            <p class="text-red-400 mb-2">שגיאה בטעינת הנתונים</p>
            <p class="text-slate-400 text-sm font-medium">בדקו ש- deals.json זמין ושהפרויקט פועל דרך שרת.</p>
          </div>`;
        }
      });
    </script>
  </body>
</html>
